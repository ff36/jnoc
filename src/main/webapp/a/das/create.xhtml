<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputStylesheet name="css/auth.css"/>
        <h:outputStylesheet name="css/common.css"/>
        <link rel="shortcut icon" type="image/png" href="#{request.contextPath}/resources/images/favicon.ico" />
        <title>#{msgs['default.page.title']} | #{msgs['admin.site.create.page.title']}</title>
    </h:head>

    <h:body>

        #{permissionUtil.hasPagePermission('site:create')}
        #{jsfSessionUser.currentUser.hasPageRole('ADMIN')}

        <h:form id="form">

            <pe:ajaxErrorHandler />

            <p:growl id="growl" 
                     redisplay="false"
                     showDetail="false" 
                     sticky="false" />

            <ez:navigation-a/>

            <pe:layout 
                       widgetVar="layourWgt" >

                <pe:layoutPane id="north" 
                               position="north" 
                               closable="false" 
                               resizable="false" 
                               size="40"/>

                <pe:layoutPane id="west" 
                               position="west" 
                               resizeWhileDragging="true" 
                               size="250">

                    <table class="navigation-sidebar">
                        <thead>
                            <tr><th>DAS Dashboard</th></tr>
                        </thead>
                        <tfoot><tr><td></td></tr></tfoot>
                        <tbody>
                            <tr>
                                <td><p:commandLink value="DAS" 
                                                   action="/a/das/list.xhtml?faces-redirect=true" 
                                                   process="@this" 
                                                   type="button"/></td>
                            </tr>
                            <tr>
                                <td class="active">Create New DAS</td>
                            </tr>
                        </tbody>
                    </table>

                </pe:layoutPane>

                <pe:layoutPane id="center" 
                               position="center" 
                               resizeWhileDragging="true">


                    <table class="page-container">
                        <thead>
                            <tr><th>New DAS</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>

                                    <h3>DAS Name*</h3>                                    
                                    <p:inputText value="#{createDas.das.name}" 
                                                 required="true" 
                                                 requiredMessage="Name is required">
                                        <p:ajax event="keyup" 
                                                update=":form:create-btn"/>
                                    </p:inputText>

                                    <h3>DMS IP*</h3> 
                                    <h:panelGrid columns="7" 
                                                 styleClass="table-align-bottom">

                                        <p:inputText id="ipa" 
                                                     value="#{createDas.das.ipAddress.ipa}" 
                                                     size="3" 
                                                     styleClass="ip-field">
                                            <p:ajax event="blur" 
                                                    update=":form:create-btn @this" 
                                                    listener="#{createDas.das.ipAddress.formatA}"/>
                                        </p:inputText>

                                        <h:outputText value="." 
                                                      styleClass="ip-field-period"/>

                                        <p:inputText id="ipb" 
                                                     value="#{createDas.das.ipAddress.ipb}" 
                                                     size="3" 
                                                     styleClass="ip-field">
                                            <p:ajax event="blur" 
                                                    update=":form:create-btn  @this" 
                                                    listener="#{createDas.das.ipAddress.formatB}"/>
                                        </p:inputText>

                                        <h:outputText value="." 
                                                      styleClass="ip-field-period"/>

                                        <p:inputText id="ipc" 
                                                     value="#{createDas.das.ipAddress.ipc}" 
                                                     size="3" 
                                                     styleClass="ip-field">
                                            <p:ajax event="blur" 
                                                    update=":form:create-btn  @this" 
                                                    listener="#{createDas.das.ipAddress.formatC}"/>
                                        </p:inputText>

                                        <h:outputText value="." 
                                                      styleClass="ip-field-period"/>

                                        <p:inputText id="ipd" 
                                                     value="#{createDas.das.ipAddress.ipd}" 
                                                     size="3" 
                                                     styleClass="ip-field">
                                            <p:ajax event="blur" 
                                                    update=":form:create-btn  @this" 
                                                    listener="#{createDas.das.ipAddress.formatD}"/>
                                        </p:inputText>

                                    </h:panelGrid>

                                    <h3>DMS Firmware *</h3>
                                    <p:selectOneMenu value="#{createDas.das.dms}" 
                                                     effect="fade"
                                                     style="width: 258px"
                                                     required="true"
                                                     requiredMessage="DMS Firmware required"> 
                                        <f:selectItem itemLabel="-" noSelectionOption="true" />
                                        <f:selectItems value="#{enumController.DMSTypes}" 
                                                       var="dms" 
                                                       itemLabel="#{dms.label}" 
                                                       itemValue="#{dms}" />
                                        <p:ajax event="change" 
                                                update="@this :form:growl"/>
                                    </p:selectOneMenu>

                                    <h3>Contact Name</h3>
                                    <h:panelGrid columns="2" 
                                                 styleClass="table-vertical-spacer">

                                        <p:inputText id="first-name" 
                                                     value="#{createDas.das.contact.firstName}"/>
                                        <p:watermark value="First Name" 
                                                     for="first-name"/>

                                        <p:inputText id="last-name" 
                                                     value="#{createDas.das.contact.lastName}"/>
                                        <p:watermark value="Last Name" 
                                                     for="last-name"/>

                                    </h:panelGrid>
                                    
                                    <h3>Contact Email</h3>
                                    <p:inputText value="#{createDas.das.contact.email}"/>
                                    
                                    <h3>Address</h3>
                                    <h:panelGrid columns="2" 
                                                 styleClass="table-vertical-spacer">

                                        <p:inputText id="address-line-two" 
                                                     value="#{createDas.das.address.lineTwo}"/>
                                        <p:watermark value="Street" 
                                                     for="address-line-two"/>

                                        <p:inputText id="address-line-three" 
                                                     value="#{createDas.das.address.lineThree}"/>
                                        <p:watermark value="City" 
                                                     for="address-line-three"/>

                                        <p:inputText id="address-line-four" 
                                                     value="#{createDas.das.address.lineFour}"/>
                                        <p:watermark value="State" 
                                                     for="address-line-four"/>

                                        <p:inputText id="address-line-five" 
                                                     value="#{createDas.das.address.lineFive}"/>
                                        <p:watermark value="Zip" 
                                                     for="address-line-five"/>

                                    </h:panelGrid>

                                    <h3>Co-ordinates</h3>
                                    <h:panelGrid columns="2" 
                                                 styleClass="table-vertical-spacer">

                                        <p:inputText id="latitude" 
                                                     value="#{createDas.das.address.latitude}"/>
                                        <p:watermark value="Latitude" 
                                                     for="latitude"/>

                                        <p:inputText id="longitude" 
                                                     value="#{createDas.das.address.longitude}"/>
                                        <p:watermark value="Longitude" 
                                                     for="longitude"/>

                                    </h:panelGrid>

                                    <h3>Installer</h3>
                                    <p:inputText id="installer" 
                                                 value="#{createDas.das.installer}"/>

                                    <h3>Support Package</h3>
                                    <p:selectOneMenu value="#{createDas.das.packageType}" 
                                                         effect="fade"
                                                         style="width: 258px">  
                                            <f:selectItem itemLabel="-" 
                                                          itemValue="" />
                                            <f:selectItem itemLabel="Monitoring" 
                                                          itemValue="Monitoring" />  
                                            <f:selectItem itemLabel="Maintenance" 
                                                          itemValue="Maintenance" />  
                                            <f:selectItem itemLabel="Monitoring and Maintenance" 
                                                          itemValue="Monitoring and Maintenance" /> 
                                        </p:selectOneMenu>
                                    
                                    <h3>Response Time</h3>
                                    <p:spinner value="#{createDas.das.responseHrs}" min="0"/> 
                                   
                                    <p:spacer width="100%" 
                                              height="20px"/>
									<p:outputPanel id="carriers">
										<table class="page-container">
											<thead>
												<tr>
													<th>
														Carriers
														<p:commandButton id="new-carrier-button" escape="false"
																		 styleClass="header-button white-button"
																		 value="Add Carrier"
																		 process="@this"
																		 onclick="PF('new-carrier-dlg').show();"
																		 actionListener="#{createDas.das.resetCarrier()}"
																		 update="@(.dlg-carrier-update-class)"/> 
													</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>
														<p:spacer width="100%" height="5px"/>
														<p:dataTable id="carriers-table" value="#{createDas.das.carriers}"
																	 var="carrier"
																	 styleClass="type2-table"
																	 emptyMessage="You do not have any carriers.">
									
															<p:column>
																<h:outputText escape="false" value="#{carrier.buildFullCarrier()}"/>
															</p:column>
									
															<p:column width="20px">
																<p:commandLink update="carriers-table" 
																			   title="Remove Carrier" 
																			   process="carriers-table">
																	<p:graphicImage value="#{uriUtil.icon('black/trash_icon_16.png', true)}"/>
																	<p:collector value="#{carrier}" 
																				 removeFrom="#{createDas.das.carriers}" 
																				 unique="true"/> 
																</p:commandLink>
															</p:column>
														</p:dataTable>                            
													</td>
												</tr>
											</tbody>
										</table>
									
									</p:outputPanel>
									
									<p:dialog id="new-carrier-dlg" 
												height="600px"
											  header="Add Carrier" 
											  widgetVar="new-carrier-dlg" 
											  dynamic="true" 
											  resizable="false">  
										<h:panelGroup id="carrier-group">
										<table>
											<tr><td colspan="4"><h2>Verizon Point of Contact</h2></td></tr>
											<tr>
												<td><h3>Name:</h3></td>
												<td>
													<p:inputText id="add-1" value="#{createDas.das.newCarrier.name}" >
													</p:inputText>
												</td>
												<td><h3>Title:</h3></td>
												<td>
													<p:inputText id="add-2" value="#{createDas.das.newCarrier.title}" >
													</p:inputText>
												</td>
											</tr>
											<tr>
												<td><h3>Phone:</h3></td>
												<td>
													<p:autoComplete id="add-3"
															value="#{createDas.das.newCarrier.phones}"
															completeMethod="#{createDas.das.newCarrier.completeInfo}"
															multiple="true">
													</p:autoComplete>
												</td>
												<td><h3>Email:</h3></td>
												<td>
													<p:autoComplete id="add-4"
															value="#{createDas.das.newCarrier.emails}"
															completeMethod="#{createDas.das.newCarrier.completeInfo}"
															multiple="true">
													</p:autoComplete>
												</td>
											</tr>
											
											<tr><td colspan="4"><h3>Verizon NOC Number</h3></td></tr>
											<tr>
												<td><h3>NOC Email:</h3></td>
												<td colspan="3">
													<p:autoComplete id="add-5"
															value="#{createDas.das.newCarrier.nocEmails}"
															completeMethod="#{createDas.das.newCarrier.completeInfo}"
															multiple="true">
													</p:autoComplete>
												</td>
											</tr>
											
											<tr><td colspan="4"><h3>Verizon Signal Source Info</h3></td></tr>
											<tr>
												<td><h3>BTS ID:</h3></td>
												<td>
													<p:inputText id="add-6" value="#{createDas.das.newCarrier.btsId}">
													</p:inputText>
												</td>
												<td><h3>Location:</h3></td>
												<td>
													<p:inputText id="add-7" value="#{createDas.das.newCarrier.location}">
													</p:inputText>
												</td>
											</tr>
											<tr>
												<td><h3>Notes:</h3></td>
												<td colspan="3">
													<p:inputTextarea id="add-8" rows="3" cols="40" autoResize="false" 
																value="#{createDas.das.newCarrier.notes}" >
													</p:inputTextarea>
												</td>
											</tr>
										</table>
										</h:panelGroup>
										<hr></hr>
										<p:commandButton id="add-carrier-button" escape="false"
														 value="Add Carrier" 
														 styleClass="green-button" 
														 update="carrier-group :form:carrier-group carriers-table"
														 process="@this @parent" 
														 action="#{createDas.das.resetCarrier()}" 
														 onsuccess="PF('new-carrier-dlg').hide()"
													>
									
											<p:collector value="#{createDas.das.newCarrier}" 
														 addTo="#{createDas.das.carriers}" 
														 unique="true"/>  
									
										</p:commandButton> 
									</p:dialog>


									<ez:blockUI target=":form:create-btn" widgetVar="blockui1"/>
									<h3>Reporting</h3>
                                    <p:selectBooleanButton value="#{createDas.das.reportingEnabled}" 
                                                           onLabel="Enabled" 
                                                           offLabel="Disabled" />
                                    
                                    <p:spacer width="100%" 
                                              height="20px"/>

                                    <p:commandButton id="create-btn" 
                                                     styleClass="green-button"
                                                     value="Create"
                                                     action="#{createDas.das.create()}"
                                                     onclick="PF('blockui1').block();"
                                                     oncomplete="PF('blockui1').unblock();"
                                                     update=":form:growl"
                                                     process="@(.page-container :input)"
                                                     disabled="#{createDas.das.name eq null or createDas.das.name.length() eq 0 or !createDas.das.ipAddress.valid()}"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
						
                </pe:layoutPane>

                <pe:layoutPane id="south" 
                               position="south" 
                               closable="false" 
                               resizable="false" 
                               size="40">
                    <ez:footer/>
                </pe:layoutPane>

            </pe:layout>

        </h:form>

    </h:body>

</html>

