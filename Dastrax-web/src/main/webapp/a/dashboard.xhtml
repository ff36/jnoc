<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputStylesheet name="css/auth-a.css"/>
        <h:outputStylesheet name="css/common.css"/>
        <link rel="shortcut icon" type="image/png" href="#{request.contextPath}/resources/graphics/favicon.ico" />
        <title>#{webBundle['default.page.title']} | #{webBundle['admin.dashboad.page.title']}</title>
    </h:head>

    <h:body>

        <h:form id="form">

            <pe:ajaxErrorHandler />

            <p:growl id="growl" 
                     redisplay="false"
                     showDetail="false" 
                     sticky="false" />

            <ez:navigation-a/>

            <pe:layout stateCookie="false" widgetVar="layoutWgt" >

                <pe:layoutPane id="west" position="west" resizeWhileDragging="true" size="220">
                    <p:spacer width="100%" height="45"/>

                    <table class="side-menu">
                        <ui:fragment rendered="#{permissionUtil.hasPermission('ticket:access')}">
                            <tr>
                                <td>
                                    <h3>Tickets</h3>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Create a new ticket" action="access-create-ticket-page" process="@this" type="button"/>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Manage tickets" action="access-list-manual-tickets-page" process="@this" type="button"/>
                                </td>
                            </tr>
                        </ui:fragment>
                        <ui:fragment rendered="#{permissionUtil.hasPermission('dmsticket:access')}">
                            <tr>
                                <td>
                                    <h3>DMS Tickets</h3>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Manage DMS tickets" action="access-list-dms-tickets-page" process="@this" type="button"/>
                                </td>
                            </tr>
                        </ui:fragment>
                        <ui:fragment rendered="#{permissionUtil.hasPermission('account:access')}">
                            <tr>
                                <td>
                                    <h3>Accounts</h3>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Create a new account" action="access-create-account-page" process="@this" type="button"/>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Manage accounts" action="access-accounts-list-page" process="@this" type="button"/>
                                </td>
                            </tr>
                        </ui:fragment>
                        <ui:fragment rendered="#{permissionUtil.hasPermission('company:access')}">
                            <tr>
                                <td>
                                    <h3>Companies</h3>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Create a new company" action="access-create-company-page" process="@this" type="button"/>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Manage companies" action="access-companies-list-page" process="@this" type="button"/>
                                </td>
                            </tr>
                        </ui:fragment>
                        <ui:fragment rendered="#{permissionUtil.hasPermission('site:access')}">
                            <tr>
                                <td>
                                    <h3>Sites</h3>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Create a new site" action="access-create-site-page" process="@this" type="button"/>
                                </td>
                            </tr>
                            <tr class="hover">
                                <td>
                                    <p:commandLink value="Manage sites" action="access-list-sites-page" process="@this" type="button"/>
                                </td>
                            </tr>
                        </ui:fragment>
                    </table>

                </pe:layoutPane>

                <pe:layoutPane id="center" position="center" resizeWhileDragging="true">
                    <p:spacer width="100%" height="45"/>

                    <div class="dsh-audit">
                        <h2>Audit</h2>
                        <p:dataList value="#{auditUtil.audits}" 
                                    var="audit"
                                    itemType="none"
                                    styleClass="clear-data-list">

                            <table style="width:100%" class="audit-table">
                                <tr class="audit-table-seperator">
                                    <td style="width: 60px">
                                        <p:graphicImage value="#{pathUtil.profileImage(audit.author eq null ? 'Anonymous' : audit.author)}"
                                                        height="40px"
                                                        styleClass="comment-image"/>

                                    </td>
                                    <td>
                                        <b>#{audit.author eq null ? 'Anonymous' : auditUtil.author(audit.author).contact.buildFullName()}</b>
                                        <h:outputText value="#{editTicket.temporalUtil.epochDateTimeFmt(audit.created)}" styleClass="comment-date"/>
                                        <p:spacer width="100%" height="1"/>
                                        #{audit.event}
                                    </td>
                                </tr>
                            </table>

                        </p:dataList>
                    </div>

                    <p:spacer width="100%" height="50"/>

                </pe:layoutPane>

            </pe:layout>

        </h:form>

        <!-- JIRA -->
        <script type="text/javascript" src="https://dastrax.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e/en_US-hgwqx7-1988229788/6132/31/1.4.0-m5/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=5962a16e"></script>


    </h:body>

</html>

