<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputStylesheet name="css/auth-b.css"/>
        <h:outputStylesheet name="css/common.css"/>
        <link rel="shortcut icon" type="image/png" href="#{request.contextPath}/resources/graphics/favicon.ico" />
        <title>#{webBundle['default.page.title']} | #{webBundle['var.settings.page.title']}</title>
    </h:head>

    <h:body>

        <h:form id="form">

            <pe:ajaxErrorHandler />

            <p:growl id="growl" 
                     redisplay="false"
                     showDetail="false" 
                     sticky="false" />

            <ez:navigation-b/>

            <pe:layout stateCookie="#{config.ProjectStage ne 'DEV'}" widgetVar="layourWgt" >

                <pe:layoutPane id="west" position="west" resizeWhileDragging="true" size="220">
                    <p:spacer width="100%" height="45"/>

                    <table class="side-menu">
                        <tr>
                            <td>
                                <h3>Settings</h3>
                            </td>
                        </tr>
                        <tr class="hover">
                            <td>
                                <p:commandLink value="Personal Profile" process="@this" update=":form:switch">
                                    <f:setPropertyActionListener target="#{settings.helper.view}" value="PROFILE"/>
                                </p:commandLink>
                            </td>
                        </tr>
                        <tr class="hover">
                            <td>
                                <p:commandLink value="Password" process="@this" update=":form:switch">
                                    <f:setPropertyActionListener target="#{settings.helper.view}" value="PASSWORD"/>
                                </p:commandLink>
                            </td>
                        </tr>
                        <tr class="hover">
                            <td>
                                <p:commandLink value="Email" process="@this" update=":form:switch">
                                    <f:setPropertyActionListener target="#{settings.helper.view}" value="EMAIL"/>
                                </p:commandLink>
                            </td>
                        </tr>
                        <tr class="hover">
                            <td>
                                <p:commandLink value="Close Account" process="@this" update=":form:switch">
                                    <f:setPropertyActionListener target="#{settings.helper.view}" value="CLOSE"/>
                                </p:commandLink>
                            </td>
                        </tr>

                    </table>

                </pe:layoutPane>

                <pe:layoutPane id="center" position="center" resizeWhileDragging="true">
                    <p:spacer width="100%" height="45"/>

                    <pe:switch id="switch" value="#{settings.helper.view}">  

                        <pe:defaultCase>  

                        </pe:defaultCase> 

                        <pe:case value="PROFILE">

                            <table width="100%">
                                <tr>
                                    <td><h2>Personal Profile</h2></td>
                                    <td width="150px"></td>
                                </tr>
                            </table>

                            <h:panelGrid columns="2" columnClasses="field-label-3">

                                <h:outputText value="First Name:" styleClass="field-label-3"/>
                                <p:inputText value="#{settings.subject.contact.firstName}"/>

                                <h:outputText value="Last Name:" styleClass="field-label-3"/>
                                <p:inputText value="#{settings.subject.contact.lastName}"/>

                            </h:panelGrid>

                            <p:spacer width="100%" height="20px"/>

                            <h3>Address</h3>

                            <p:spacer width="100%" height="5px"/>

                            <p:panel>
                                <h:panelGrid id="address-grid" columns="2" columnClasses="field-label-3">

                                    <h:outputText value="Street:"/>
                                    <p:inputText value="#{settings.helper.address.lineTwo}"/>

                                    <h:outputText value="City:"/>
                                    <p:inputText value="#{settings.helper.address.lineThree}"/>

                                    <h:outputText value="State:"/>
                                    <p:inputText value="#{settings.helper.address.lineFour}"/>

                                    <h:outputText value="Zip Code:"/>
                                    <p:inputText value="#{settings.helper.address.lineFive}"/>

                                    <p:commandButton id="btn_add" value="Add" 
                                                     update="address-grid address-table" 
                                                     process="@this,address-grid"
                                                     action="#{settings.helper.addAddress()}"/>

                                </h:panelGrid>
                            </p:panel>

                            <p:spacer width="100%" height="10px"/>

                            <p:dataTable id="address-table" value="#{settings.subject.contact.addresses}" var="address">  

                                <p:column>  
                                    <f:facet name="header">  
                                        <h:outputText value="Address" />  
                                    </f:facet>  
                                    <h:outputText value="#{address.buildCompleteAddress()}" />  
                                </p:column>  

                                <p:column>  
                                    <p:commandLink value="Remove" update="address-table" process="@this,address-table"
                                                   action="#{settings.subject.contact.removeAddress(address)}"/>  
                                </p:column>  

                            </p:dataTable>

                            <p:spacer width="100%" height="20px"/>

                            <h3>Telephone</h3>

                            <p:spacer width="100%" height="5px"/>

                            <p:panel>
                                <h:panelGrid id="tel-grid" columns="1" columnClasses="field-label-3">

                                    <ez:telephone type="#{settings.helper.telephone.type}"
                                                  coutry="#{settings.helper.telephone.country}"                     
                                                  number="#{settings.helper.telephone.localNumber}"/>

                                    <p:commandButton value="Add" 
                                                     update="tel-grid tel-table" 
                                                     process="@this,tel-grid"
                                                     action="#{settings.helper.addTelephone()}"/>

                                </h:panelGrid>
                            </p:panel>

                            <p:spacer width="100%" height="10px"/>

                            <p:dataTable id="tel-table" value="#{settings.subject.contact.telephones}" var="telephone">  

                                <p:column>  
                                    <f:facet name="header">  
                                        <h:outputText value="Number" />  
                                    </f:facet>  
                                    <h:outputText value="#{telephone.type}: #{telephone.internationalFormat()}" />  
                                </p:column>  

                                <p:column>  
                                    <p:commandLink value="Remove" update="tel-table" process="@this,tel-table"
                                                   action="#{settings.subject.contact.removeTelephone(telephone)}"/>  
                                </p:column>  

                            </p:dataTable>

                            <p:spacer width="100%" height="20px"/>

                            <p:commandButton id="profile-save-btn" 
                                             value="Save"
                                             action="#{settings.saveContact()}"
                                             onclick="blockui1.block();"
                                             oncomplete="blockui1.unblock();"
                                             update=":form:growl"
                                             process="@this,:form:switch"/>

                            <pe:blockUI target="profile-save-btn" widgetVar="blockui1">  
                                <div class="windows8-18-b">
                                    <div class="wBall" id="wBall_1">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_2">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_3">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_4">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_5">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                </div> 
                            </pe:blockUI>

                        </pe:case>

                        <pe:case value="PASSWORD">

                            <table width="100%">
                                <tr>
                                    <td><h2>Change Password</h2></td>
                                    <td width="150px"></td>
                                </tr>
                            </table>

                            <h:outputText value="You can use this section to edit your account password. We have implemented some restrictions on passwords to make sure that you use one that is sufficiently strong. "/>

                            <p:spacer width="100%" height="10"/>

                            <h:panelGrid columns="2" columnClasses="field-label-3">

                                <h:outputText value="Minimum Length:"/>
                                <h:outputText value="5 characters"/>

                                <h:outputText value="Lower Case Letter:"/>
                                <h:outputText value="Minimum of 1"/>

                                <h:outputText value="Upper Case Letter:"/>
                                <h:outputText value="Minimum of 1"/>

                                <h:outputText value="Number:"/>
                                <h:outputText value="Minimum of 1"/>

                                <h:outputText value="Other:"/>
                                <h:outputText value="Can not be your email"/>

                            </h:panelGrid>

                            <p:spacer width="100%" height="10"/>

                            <h:panelGrid columns="2" columnClasses="field-label-3">  

                                <h:outputText value="Current Password*:"/>  
                                <p:password value="#{settings.helper.principalPsw}"
                                            required="true"
                                            requiredMessage="Current Password Required"/>

                                <p:spacer width="10px" height="20px"/>
                                <p:spacer width="10px" height="20px"/>


                                <h:outputText value="New Password*:"/>
                                <p:password value="#{settings.helper.tempPswA}"
                                            required="true"
                                            requiredMessage="New Password Required"
                                            feedback="true"/>

                                <h:outputText value="Retype New Password*:"/>
                                <p:password value="#{settings.helper.tempPswB}"
                                            required="true"
                                            requiredMessage="Please retype your new password"/>

                            </h:panelGrid>

                            <p:spacer width="100%" height="20"/>

                            <p:commandButton id="change-psw-btn" 
                                             value="Save"
                                             action="#{settings.savePassword()}"
                                             onclick="blockui2.block();"
                                             oncomplete="blockui2.unblock();"
                                             update=":form:growl"
                                             process="@this,:form:switch"/>

                            <pe:blockUI target="change-psw-btn" widgetVar="blockui2">  
                                <div class="windows8-18-b">
                                    <div class="wBall" id="wBall_1">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_2">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_3">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_4">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_5">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                </div> 
                            </pe:blockUI>

                        </pe:case>

                        <pe:case value="EMAIL">

                            <table width="100%">
                                <tr>
                                    <td><h2>Email</h2></td>
                                    <td width="150px"></td>
                                </tr>
                            </table>

                            <h:outputText value="You can use this section to change your account email address. This is the address you sign into your account with! An email will be sent to you with instructions on how to complete the process."/>

                            <p:spacer width="100%" height="10"/>

                            <table>
                                <tr>
                                    <td><h:outputText value="New Email:*" styleClass="field-label-3"/></td>
                                    <td style="position: relative">
                                        <p:inputText id="email" styleClass="ajax-val" value="#{settings.helper.newEmail}" required="true" requiredMessage="Email is required">
                                            <p:ajax process="@this,email" event="keyup" listener="#{ajaxValidUtil.emailAvailable(component)}" update="email-val change-email-btn"/>
                                        </p:inputText>
                                        <h:outputText id="email-val" value="#{ajaxValidUtil.emailFree ? 'Available' : 'Not Available'}" styleClass="#{ajaxValidUtil.emailFree ? 'positive-field' : 'negative-field'}"/>                                                       
                                    </td>
                                </tr>
                            </table>

                            <p:spacer width="100%" height="20"/>

                            <p:commandButton id="change-email-btn" 
                                             value="Send Email"
                                             action="#{settings.changeEmailRequest()}"
                                             onclick="blockui3.block();"
                                             oncomplete="blockui3.unblock();"
                                             update=":form:growl"
                                             process="@this,:form:switch"
                                             disabled="#{!ajaxValidUtil.emailFree}"/>

                            <pe:blockUI target="change-email-btn" widgetVar="blockui3">  
                                <div class="windows8-18-b">
                                    <div class="wBall" id="wBall_1">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_2">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_3">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_4">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_5">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                </div> 
                            </pe:blockUI>

                        </pe:case>

                        <pe:case value="CLOSE">

                            <table width="100%">
                                <tr>
                                    <td><h2>Close Account</h2></td>
                                    <td width="150px"></td>
                                </tr>
                            </table>

                            <h:outputText value="If you would like to delete your account you can do so by clicking the button below. Please be very careful as this cannot be undone."/>

                            <p:spacer width="100%" height="10"/>
                            
                            <h:panelGrid columns="2"  columnClasses="field-label-3">

                                <h:outputText value="Password:*"/>
                                <p:password value="#{settings.helper.principalPsw}"/>

                            </h:panelGrid>

                            <p:spacer width="100%" height="20"/>

                            <p:commandButton id="close-account-btn" 
                                             value="Close Account"
                                             action="#{settings.closeAccount()}"
                                             onclick="blockui4.block();"
                                             oncomplete="blockui4.unblock();"
                                             update=":form:growl"
                                             process="@this,:form:switch"/>

                            <pe:blockUI target="close-account-btn" widgetVar="blockui4">  
                                <div class="windows8-18-b">
                                    <div class="wBall" id="wBall_1">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_2">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_3">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_4">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                    <div class="wBall" id="wBall_5">
                                        <div class="wInnerBall">
                                        </div>
                                    </div>
                                </div> 
                            </pe:blockUI>

                        </pe:case>

                    </pe:switch>

                </pe:layoutPane>

            </pe:layout>

        </h:form>

        <!-- JIRA -->
        <script type="text/javascript" src="https://dastrax.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e/en_US-hgwqx7-1988229788/6132/31/1.4.0-m5/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=5962a16e"></script>


    </h:body>

</html>

